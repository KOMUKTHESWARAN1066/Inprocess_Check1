// @flow
import React from 'react';
import { DatePickerIOS, View, InteractionManager } from 'react-native';
import { ModalHeader } from 'react-native-custom-modals';
import { InteractableModal } from 'react-native-custom-modals/Interactable';

class CustomDatePickerIOS extends React.Component {
  modal: { show: () => {} };
  state = {
    date: new Date()
  };

  onPress = () => {
    this.setState({ date: this.props.date ? this.props.date : new Date() });
    if (this.modal) this.modal.show();
  };

  onSave = () => {
    this.props.onSave(this.state.date);
    this.modal.hide();
  };

  render() {
    const Component = this.props.component;
    return (
      <View>
        <Component {...this.props} onPress={this.onPress} />
        <InteractableModal
          height={246}
          puffer={20}
          onSave={this.onSave}
          ref={component => (this.modal = component)}
        >
          <ModalHeader onSave={this.onSave} onClose={() => this.modal.hide()} />
          <DatePickerIOS
            mode={'datetime'}
            date={this.state.date}
            onDateChange={date => this.setState({ date })}
          />
        </InteractableModal>
      </View>
    );
  }
}

export default CustomDatePickerIOS;
